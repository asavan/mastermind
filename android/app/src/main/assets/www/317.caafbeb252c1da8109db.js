"use strict";(self.webpackChunkmastermind=self.webpackChunkmastermind||[]).push([[317],{317:(e,t,r)=>{r.r(t),r.d(t,{default:()=>h});var n=r(661),o=r(387);const s=function(e){return{player:t=>e.testSecret(t),sendSecret:t=>e.tellSecret(t),sendAnswer:t=>e.takeResp(t)}};var c=r(541);function a(e,t){const r={method:t};return r[t]=e,JSON.stringify(r)}function h(e,t,r,h){return new Promise(((l,m)=>{const i=(0,n.A)(r,e.location),d=r.color,u=r.sh||e.location.href,f=t.getElementsByClassName("log")[0];i.on("error",(e=>{(0,c.Rm)(r,e,f)})),i.on("socket_open",(()=>{const r=e.location.search,n=new URLSearchParams(r),s=new URL(u);s.search=n,s.searchParams.delete("wh"),s.searchParams.delete("sh"),s.searchParams.set("color",i.getOtherColor(d)),s.searchParams.set("currentMode","net");const a=(0,o.A)(s.toString(),t.querySelector(".qrcode"));i.on("socket_close",(()=>{(0,c.k6)(a)}))})),i.on("open",(()=>{const n=h(e,t,r),o=s(n);i.on("recv",(e=>{const t=JSON.parse(e),r=t[t.method],n=o[t.method];"function"==typeof n&&n(r)}));for(const[e]of Object.entries(o))n.on(e,(t=>i.sendMessage(a(t,e))));l(n)}));try{i.connect()}catch(e){(0,c.Rm)(r,e,f),m(e)}}))}}}]);