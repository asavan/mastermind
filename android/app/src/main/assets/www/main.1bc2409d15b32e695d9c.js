(()=>{"use strict";var e,t,n={541:(e,t,n)=>{function r(e){e&&e.remove()}function o(e,t,n){e.logger&&(n.innerHTML+="object"==typeof t?(JSON&&JSON.stringify?JSON.stringify(t):t)+"<br />":t+"<br />")}function s(e){switch(e.toLowerCase().trim()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function i(e,t,n){const r=e.location.search,o=new URLSearchParams(r);for(const[e,t]of o)"number"==typeof n[e]?n[e]=parseInt(t,10):"boolean"==typeof n[e]?n[e]=s(t):n[e]=t}n.d(t,{P$:()=>i,Rm:()=>o,cb:()=>a,k6:()=>r,td:()=>c,vA:()=>u});const a=e=>new Promise((t=>setTimeout(t,e)));function u(e,t){if(!e)throw t}function c(e,t,n="s"){return`${e} ${t}${1!==e?n:""}`}}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var s=r[e]={exports:{}};return n[e](s,s.exports,o),s.exports}o.m=n,o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,n)=>(o.f[n](e,t),t)),[])),o.u=e=>e+"."+{111:"1ba8011d47daff7e8cdd",187:"7376f59a13b2ed3d05a9",218:"341ce05ef94ba4a34766",317:"caafbeb252c1da8109db"}[e]+".js",o.miniCssF=e=>{},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="mastermind:",o.l=(n,r,s,i)=>{if(e[n])e[n].push(r);else{var a,u;if(void 0!==s)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==t+s){a=f;break}}a||(u=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+s),a.src=n),e[n]=[r];var d=(t,r)=>{a.onerror=a.onload=null,clearTimeout(m);var o=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(r))),t)return t(r)},m=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),u&&document.head.appendChild(a)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={792:0};o.f.j=(t,n)=>{var r=o.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var s=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=s);var i=o.p+o.u(t),a=new Error;o.l(i,(n=>{if(o.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=n&&("load"===n.type?"missing":n.type),i=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",a.name="ChunkLoadError",a.type=s,a.request=i,r[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var r,s,[i,a,u]=n,c=0;if(i.some((t=>0!==e[t]))){for(r in a)o.o(a,r)&&(o.m[r]=a[r]);if(u)u(o)}for(t&&t(n);c<i.length;c++)s=i[c],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0},n=self.webpackChunkmastermind=self.webpackChunkmastermind||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{const e={modes:["net","ai","server"],currentMode:"ai",wsPort:8088,color:"blue",size:4,logger:!0,repeat:!1,min:1,max:6,maxMoves:8,cheating:!1};var t=o(541);function n(e){const t=[];for(;e>0;)t.push(e%10),e=Math.floor(e/10);return t.reverse(),t}function r(e,t){let n=0;for(let r=0;r<e.length;++r)e[r]==t[r]&&(e.splice(r,1),t.splice(r,1),++n,--r);e.sort(),t.sort();const r=function(e,t){let n=0,r=0;const o=[];for(;n<e.length&&r<t.length;)e[n]<t[r]?n++:(e[n]>t[r]||(o.push(e[n]),n++),r++);return o}(e,t);return 10*n+r.length}function s(e,t){return r(Array.from(e).map((e=>parseInt(e,10))),Array.from(t).map((e=>parseInt(e,10))))}function i(e){return{testNum:function(t){return r(e.slice(),n(t))},isWinNum:function(t){return t===10*e.length},testStr:function(t){return s(e,t)}}}const a={fromString:function(e){return i(Array.from(e).map((e=>parseInt(e,10))))},fromNum:function(e){return i(n(e))}};function u(e,t,n,r,o){if(n>=e)r.add(o);else for(let s=1;s<=t;++s)u(e,t,n+1,r,10*o+s)}function c(e,t){const n=new Set;return u(e,t,0,n,0),n}const l={generateAllVariants:c,simpleGuesser:function(e,t){const n=c(e,t);let r=Array.from(n),o=0,s=0;function i(e,t){++o;const n=a.fromNum(e);r=r.filter((e=>n.testNum(e)===t))}return{init:function(e){for(const[t,n]of e)i(t,n)},learn:i,tryGuessNum:()=>(++s,r[0]),getRest:function(){return Array.from(r)},getRestUnsafe:()=>r,getInitialSet:()=>n,isLogicalMove:e=>r.includes(e),getGuessCount:()=>s,getTotalCount:()=>o,isFirst:()=>0===o}},genArray:function(e,t,n){const r=Math.floor(Math.pow(t,e));return new Array(r).fill(n)}},f=(e,t)=>{const n=e+Math.random()*(t-e);return Math.floor(n)},d={randomInteger:f,randEl:e=>e[f(0,e.length)]};function m(e,t){const n=l.simpleGuesser(e,t),r=n.getInitialSet(),o=n.init,s=n.isFirst,i=n.getRestUnsafe,u=(e,t,n)=>{const r=Math.min(...e),o=[];for(const s of t)if(e[s]===r){if(n.has(s))return s;o.push(s)}return o[0]},c=o=>((n,r,o)=>{const s=Math.floor(Math.pow(10,e)),i=Math.floor(Math.pow(t,e))+1,u=10*e+1,c=new Array(s).fill(i);for(const e of r){const t=new Array(u).fill(0),r=a.fromNum(e);for(const e of n)++t[r.testNum(e)];const o=Math.max(...t);c[e]=o}return o(c,r,n)})(new Set(n.getRestUnsafe()),r,o);return{init:o,learn:(e,t)=>(r.delete(e),n.learn(e,t)),tryGuessNum:()=>c(u),getRestUnsafe:i,isFirst:s,getCode:c}}function p(e,t){const n=m(e,t),r=n.learn,o=n.init,s=n.isFirst,i=n.getRestUnsafe,a=(e,t,n)=>{const r=Math.min(...e),o=[],s=[];for(const i of t)e[i]===r&&(n.has(i)?s.push(i):o.push(i));return s.length>0?d.randEl(s):d.randEl(o)};return{init:o,learn:r,tryGuessNum:()=>n.getCode(a),getRestUnsafe:i,isFirst:s}}const h={simple:m,fast:function(){const e=m(4,6),t=e.learn;return{init:e.init,learn:t,tryGuessNum:()=>e.isFirst()?1122:e.tryGuessNum()}},random:p,random_fast:function(){const e=p(4,6),t=e.learn,r=e.init,o=e.getRestUnsafe().filter((e=>{const t=n(e);return t.sort(),t[0]===t[1]&&t[1]!==t[2]&&t[2]===t[3]}));return{init:r,learn:t,tryGuessNum:()=>e.isFirst()?d.randEl(o):e.tryGuessNum()}}};function g(){}let y="";function v(e){y="";for(const t of e)t.value?y+=t.value:y+=" "}function b(e,t){if(t.length!==e.size)return!1;for(const n of t){const t=parseInt(n,10);if(isNaN(t)||t<e.min||t>e.max)return!1}return!0}function w(e,t){if(t.length!==e.size)return!1;const n=new Set;for(const r of t){const t=parseInt(r,10);if(isNaN(t)||t<e.min||t>e.max)return!1;n.add(t)}return e.repeat||n.size===e.size}function S(e,t,n,r,o,s){let i=!1;function a(){for(const e of t)e.value="";v(t)}e.onkeydown=e=>{if("Backspace"===e.key){const t=parseInt(e.target.getAttribute("data-index"),10);return!(isNaN(t)||t<0)&&(i=y[t]&&" "!==y[t],!0)}return!0},e.onkeyup=e=>{const s=parseInt(e.target.getAttribute("data-index"),10);if(isNaN(s)||s<0)return!1;if("Enter"===e.key)return o(n,y)&&(r(y),a()),!1;if("Backspace"===e.key){let e=s-1;return(i||e<0)&&(e=s),i=!1,t[e].value="",t[e].focus(),v(t),!1}const u=t[s].value;if(""===u||u<n.min.toString()||u>n.max.toString())return t[s].value="",v(t),!1;v(t),o(n,y)?setTimeout((()=>{o(n,y)&&(r(y),a())}),200):function(e,t,n){for(let r=0;r<t.length;++r){const o=(r+e+1)%t.length,s=parseInt(t[o].value,10);if(isNaN(s)||s<n.min||s>n.max)return t[o].value="",t[o].focus(),o}}(s,t,n)}}function N(e,r,o){const i=r.getElementsByClassName("overlay")[0],a=r.getElementsByClassName("close")[0],u=r.getElementsByClassName("install")[0],c=r.querySelector("#result-row"),l=r.querySelector(".result"),f=r.querySelector(".input-div");let d=null;1===o.min&&6===o.max&&4===o.size&&o.cheating&&(d=h.fast()),function(e,t,n){t.documentElement.style.setProperty("--field-size",n.size);const r=t.querySelector(".input-div"),o=t.querySelector("#cell");for(let e=0;e<n.size;++e){const t=o.content.cloneNode(!0);t.querySelector("input").dataset.index=e,r.appendChild(t.firstElementChild)}}(0,r,o);const m=f.getElementsByTagName("input");let p,y,v=o.maxMoves+1,N=o.maxMoves+1,M=!1,A=!1,C=null,k=null,x=!1,E=0;function I(e,t){i.querySelector("h2").textContent=e;i.querySelector(".content").textContent=t,i.classList.add("show"),u.classList.remove("hidden2"),f.classList.add("hidden"),L.gameover(E)}function P(){E-=1,I("You loose","Secret was "+p)}function T(){x=!0;for(const e of m)e.disabled=!0}function q(){x=!1;let e=new Array(o.size).fill(0);if(d){e=n(d.tryGuessNum())}let t=0;for(const n of m)n.disabled=!1,e[t]&&(n.placeholder=e[t]),++t;m[0].focus()}function z(){N<=v&&q()}a.addEventListener("click",(e=>{e.preventDefault(),i.classList.remove("show")}),!1);const L={player:g,sendSecret:g,sendAnswer:g,gameover:g};async function R(e){T(),k=e;const t=c.content.cloneNode(!0);t.querySelector(".request").textContent=e,C=l.appendChild(t.firstElementChild),--v;const n=await L.player(e);d&&d.learn(e,n),z()}async function G(t){T(),y=t,--v;const n=await L.sendSecret(t);return S(e,m,o,R,b),z(),n}function U(){if(!A&&!M)return void(v<=0&&P());const e=o.maxMoves-v,n=o.maxMoves-N;if(A&&M&&e===n)return r=e,E+=.5,void I("Draw","In "+(0,t.td)(r,"move"));var r;A&&e<=n?function(e){E+=1,I("You win","In "+(0,t.td)(e,"move"))}(e):M&&n<=e&&P()}"net"===o.currentMode&&S(e,m,o,G,w);return q(),{on:function(e,t){L[e]=t},takeResp:function(e){if(p){const n=function(e,t,n){return e===s(t,n)}(e,p,k);(0,t.vA)(o.cheating||n,"Cheating detected")}else(0,t.vA)(o.cheating,"Cheating detected2");if(C){C.querySelector(".response").textContent=String(e).padStart(2,"0")}else(0,t.vA)(!1,e);e==10*o.size&&(A=!0),U()},tellSecret:function(e){o.cheating||((0,t.vA)(e,"Not valid secret"),(0,t.vA)(!p||p==e,"Unable to change secret")),p=e,--N,z()},testSecret:async function(e){const t=s(y,e);return M=t===10*o.size&&"ai"!==o.currentMode,--N,await L.sendAnswer(t),z(),U(),t},setMyNumber:G,getScore:()=>E}}(function(n,r){(0,t.P$)(n,r,e),"net"===e.currentMode?Promise.all([o.e(111),o.e(317)]).then(o.bind(o,317)).then((t=>{t.default(n,r,e,N)})):"server"===e.currentMode||"black"===e.color?Promise.all([o.e(111),o.e(218)]).then(o.bind(o,218)).then((t=>{e.color="black",t.default(n,r,e)})):"ai"===e.currentMode?o.e(187).then(o.bind(o,187)).then((t=>{t.default(n,r,e,N).then((e=>{e.on("gameover",(e=>{r.querySelector(".butInstall").classList.remove("hidden2")}))}))})):(0,t.vA)(!1,"Unsupported mode")})(window,document)})()})();